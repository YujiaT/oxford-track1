read.csv("week1")
week1 = read.csv("week1")
week1 = read.csv("week1.csv")
week2 = read.csv("week2.csv")
week3 = read.csv("week3.csv")
source(library)
source("library.R")
source(library.R)
source(library.R)
source("libraries.R")
View(week1)
View(week2)
View(week3)
week1 = read.csv("week1.csv")
week2 = read.csv("week2.csv")
week3 = read.csv("week3.csv")
View(week1)
View(week2)
View(week3)
setwd("D:/Oxford Track Project/oxford-track1")
PM = read.csv("PM.csv")
day1 = read.csv("day1.csv")
#no recording time and date!
wind = read.csv("WeatherData.csv")
View(day1)
back = total[total$Winddirection == "180",]
source("libraries.R")
total = merge(PM, wind)
#wind data: 4/9-4/13
plot(day1$DateNum, day1$Difference_in_Small)
plot(day1$DateNum, day1$SW_Small)
windback = subset(wind, wind$Winddirection == "180")
windfor = subset(wind, wind$Winddirection > 300)
back = total[total$Winddirection == "180",]
forw = total[total$Winddirection > 300, ]
plot(forw$DateNum, forw$SW_Small)
plot(back$DateNum, back$SW_Small)
plot(back$Difference_in_Small)
summary(back$Difference_in_Small)
pmfor1 = PM[7:17,]
pmfor2 = PM[39:51,]
pmfor3 = PM[65:80,]
pmfor = rbind(pmfor1,pmfor2,pmfor3)
pmfor$winddirection = 315
summary(pmfor$Difference_in_Small)
pmback1 = PM[1:6,]
summary(pmfor$Difference_in_Small)
pmback1 = PM[1:6,]
pmback2 = PM[18:38,]
pmback3 = PM[52:64,]
pmback4 = PM[81:93,]
pmback = rbind(pmback1,pmback2,pmback3,pmback4)
View(pmback)
summary(pmfor$Difference_in_Small)
pmback = rbind(pmback1,pmback2,pmback3,pmback4)
summary(pmback$Difference_in_Small)
?standarddeviation
?standard deviation
?deviation
pmfor2 = PM[39:51,]
pmfor3 = PM[65:80,]
std(pmback$Difference_in_Small)
pmback$Difference_in_Small = -1 * pmback$Difference_in_Small
summary(pmback$Difference_in_Small)
sd(pmback$Difference_in_Small)
sd(pmfor$Difference_in_Small)
pm2 = rbind(pmfor, pmback)
boxplot(pm2$winddirection,pm2$Difference_in_Small)
pmback$winddirection = 180
pm2 = rbind(pmfor, pmback)
boxplot(pm2$winddirection,pm2$Difference_in_Small)
summary(lm(pm2$Difference_in_Small~pm2$winddirection))
pmfor1 = PM[7:17,]
pmfor2 = PM[39:51,]
pmfor3 = PM[65:80,]
pmfor = rbind(pmfor1,pmfor2,pmfor3)
pmfor$winddirection = 315
pmfor$industryPM = "with industrial PM input"
summary(pmfor$Difference_in_Small)
pmback1 = PM[1:6,]
pmback2 = PM[18:38,]
pmback3 = PM[52:64,]
pmback4 = PM[81:93,]
pmback = rbind(pmback1,pmback2,pmback3,pmback4)
pmback$industryPM = "without industrial PM input"
pmback$Difference_in_Small = -1 * pmback$Difference_in_Small
summary(pmback$Difference_in_Small)
pmback$winddirection = 180
pm2 = rbind(pmfor, pmback)
boxplot(pm2$winddirection,pm2$Difference_in_Small, title = "Difference in >1um PM after passing the farm", xlab = "with industrial PM input")
boxplot(pm2$winddirection,pm2$Difference_in_Small, title = "Difference in >1um PM after passing the farm")
?boxplot
boxplot(pm2$winddirection,pm2$Difference_in_Small, names = "Difference in >1um PM after passing the farm")
boxplot(pm2$winddirection,pm2$Difference_in_Small, main = "Difference in >1um PM after passing the farm")
boxplot(pm2$winddirection,pm2$Difference_in_Small, main = "Difference in >1um PM after passing the farm", ylab = "#PM difference from upwind to downwind")
boxplot(pm2$industryPM,pm2$Difference_in_Small, main = "Difference in >1um PM after passing the farm", ylab = "#PM difference from upwind to downwind")
boxplot(pm2$industryPM, pm2$Difference_in_Small, main = "Difference in >1um PM after passing the farm", ylab = "#PM difference from upwind to downwind")
boxplot(pm2$Difference_in_Small, main = "Difference in >1um PM after passing the farm", ylab = "#PM difference from upwind to downwind")
boxplot(pm2$winddirection,pm2$Difference_in_Small, main = "Difference in >1um PM after passing the farm", ylab = "#PM difference from upwind to downwind")
level(pm2$winddirection)
boxplot(pm2$winddirection,pm2$Difference_in_Small, main = "Difference in size 1-5 um PM after passing the farm", ylab = "#PM difference from upwind to downwind")
plot(day1$DateNum, day1$Difference_in_Small)
plot(day1$DateNum, day1$SW_Small)
windback = subset(wind, wind$Winddirection == "180")
windfor = subset(wind, wind$Winddirection > 300)
#half of time wind is backwards
#7am - 7pm wind 180 backward
#7pm - 7am wind 315 forward --- should get a large difference
#back means away from the industrial PM source
back = total[total$Winddirection == "180",]
forw = total[total$Winddirection > 300, ]
plot(forw$DateNum, forw$SW_Small)
plot(back$DateNum, back$SW_Small)
plot(back$Difference_in_Small)
summary(back$Difference_in_Small)
summary(forw$Difference_in_Small)
#this is significant!
summary(lm(total$Difference_in_Small ~ total$Winddirection))
#not enough data
#just assume the 7-7 period wind direction is constant for all?
pmfor1 = PM[7:17,]
pmfor2 = PM[39:51,]
pmfor3 = PM[65:80,]
pmfor = rbind(pmfor1,pmfor2,pmfor3)
pmfor$winddirection = 315
pmfor$industryPM = "with industrial PM input"
summary(pmfor$Difference_in_Small)
pmback1 = PM[1:6,]
pmback2 = PM[18:38,]
pmback3 = PM[52:64,]
pmback4 = PM[81:93,]
pmback = rbind(pmback1,pmback2,pmback3,pmback4)
pmback$industryPM = "without industrial PM input"
pmback$Difference_in_Small = -1 * pmback$Difference_in_Small
summary(pmback$Difference_in_Small)
pmback$winddirection = 180
pm2 = rbind(pmfor, pmback)
boxplot(pm2$winddirection,pm2$Difference_in_Small, main = "Difference in size 1-5 um PM after passing the farm", ylab = "#PM difference from upwind to downwind")
summary(lm(pm2$Difference_in_Small~pm2$winddirection))
total$retentiontime = 200 / (total$WindCurrent)
x = total[total$retentiontime != Inf,]
y = total[total$retentiontime == Inf,]
y$retentiontime = 200
total = rbind(x,y)
summary(lm(total$Difference_in_Small~ total$retentiontime))
plot(pm2$winddirection,pm2$Difference_in_Small, main = "Difference in size 1-5 um PM after passing the farm", ylab = "#PM difference from upwind to downwind")
View(pm2)
summary(lm(pm2$SW_Small~pm2$winddirection))
summary(lm(pm2$Difference_in_Small~pm2$SW_Small))
plot(pm2$Difference_in_Small~pm2$SW_Small)
plot(pm2$Difference_in_Small~pm2$NE_Small)
summary(lm(pm2$Difference_in_Small~pm2$NE_Small))
boxplot(pmfor$week, pmfor$SW_Small)
View(pmfor)
pmfor3$Week = 3
pmfor1 = PM[7:17,]
pmfor1$Week = 1
pmfor2 = PM[39:51,]
pmfor2$Week = 2
pmfor3 = PM[65:80,]
pmfor3$Week = 3
pmfor = rbind(pmfor1,pmfor2,pmfor3)
pmfor$winddirection = 315
boxplot(pmfor$week, pmfor$SW_Small)
View(pmfor)
boxplot(pmfor$Week, pmfor$SW_Small)
boxplot(pmfor$Week, pmfor$SW_Small)
summary(pmfor1$Difference_in_Small)
summary(pmfor2$Difference_in_Small)
summary(pmfor3$Difference_in_Small)
boxplot(pmfor$Week, pmfor$Difference_in_Small)
plot(pmfor$Week, pmfor$Difference_in_Small)
summary(lm(pmfor$Difference_in_Small ~ pmfor$Week))
pmfor1$coverage = 0
summary(pmfor1$Difference_in_Small)
pmfor2 = PM[39:51,]
pmfor2$Week = 2
pmfor1$coverage = 0
summary(pmfor2$Difference_in_Small)
pmfor3 = PM[65:80,]
pmfor3$Week = 3
pmfor1$coverage = 3000
pmfor = rbind(pmfor1,pmfor2,pmfor3)
summary(pmfor3$Difference_in_Small)
pmfor$winddirection = 315
plot(pmfor$Week, pmfor$Difference_in_Small)
summary(lm(pmfor$Difference_in_Small ~ pmfor$Week))
summary(lm(pmfor$Difference_in_Small ~ pmfor$coverage))
pmfor2$coverage = 0
pmfor3$coverage = 3000
pmfor = rbind(pmfor1,pmfor2,pmfor3)
summary(pmfor3$Difference_in_Small)
pmfor$winddirection = 315
plot(pmfor$Week, pmfor$Difference_in_Small)
summary(lm(pmfor$Difference_in_Small ~ pmfor$coverage))
plot(pmfor$coverage, pmfor$Difference_in_Small)
summary(lm(pmfor$Difference_in_Small ~ pmfor$coverage))
pmback_control = rbind(pmback1,pmback2,pmback3)
pmback_control$coverage = 0
pmback4 = PM[81:93,]
pmback4$coverage = 3000
pmback = rbind(pmback_control,pmback4)
pmback$industryPM = "without industrial PM input"
pmback$Difference_in_Small = -1 * pmback$Difference_in_Small
summary(pmback$Difference_in_Small)
plot(pmback$coverage, pmback$Difference_in_Small)
summary(lm(pmback$Difference_in_Small ~ pmback$coverage))
pm2 = rbind(pmfor, pmback)
summary(pmback$Difference_in_Small)
pmback$winddirection = 180
pm2 = rbind(pmfor, pmback)
PM = read.csv("PM.csv")
day1 = read.csv("day1.csv")
#no recording time and date!
wind = read.csv("WeatherData.csv")
source("libraries.R")
#wind data: 4/9-4/13
plot(day1$DateNum, day1$SW_Small)
windfor = subset(wind, wind$Winddirection > 300)
#half of time wind is backwards
#7am - 7pm wind 180 backward
#7pm - 7am wind 315 forward --- should get a large difference
#back means away from the industrial PM source
back = total[total$Winddirection == "180",]
forw = total[total$Winddirection > 300, ]
plot(forw$DateNum, forw$SW_Small)
plot(back$DateNum, back$SW_Small)
plot(back$Difference_in_Small)
summary(back$Difference_in_Small)
summary(forw$Difference_in_Small)
#this is significant!
summary(lm(total$Difference_in_Small ~ total$Winddirection))
#not enough data
#just assume the 7-7 period wind direction is constant for all?
pmfor1 = PM[7:17,]
summary(pmfor1$Difference_in_Small)
pmfor2 = PM[39:51,]
pmfor2$coverage = 0
total = merge(PM, wind)
plot(day1$DateNum, day1$Difference_in_Small)
pmfor1$coverage = 0
windback = subset(wind, wind$Winddirection == "180")
summary(pmfor2$Difference_in_Small)
pmfor3 = PM[65:80,]
pmfor3$coverage = 3000
pmfor$winddirection = 315
summary(pmfor3$Difference_in_Small)
pmfor = rbind(pmfor1,pmfor2,pmfor3)
plot(pmfor$coverage, pmfor$Difference_in_Small)
pmfor$industryPM = "with industrial PM input"
summary(lm(pmfor$Difference_in_Small ~ pmfor$coverage))
pmback1 = PM[1:6,]
pmback2 = PM[18:38,]
pmback3 = PM[52:64,]
pmback_control = rbind(pmback1,pmback2,pmback3)
summary(pmfor$Difference_in_Small)
pmback_control$coverage = 0
pmback4 = PM[81:93,]
pmback4$coverage = 3000
pmback = rbind(pmback_control,pmback4)
pmback$industryPM = "without industrial PM input"
plot(pmback$coverage, pmback$Difference_in_Small)
summary(lm(pmback$Difference_in_Small ~ pmback$coverage))
pmback$Difference_in_Small = -1 * pmback$Difference_in_Small
summary(pmback$Difference_in_Small)
pmback$winddirection = 180
pm2 = rbind(pmfor, pmback)
View(pmback)
View(pmfor)
pmfor$winddirection = 315
pm2 = rbind(pmfor, pmback)
boxplot(pm2$winddirection,pm2$Difference_in_Small, main = "Difference in size 1-5 um PM after passing the farm", ylab = "#PM difference from upwind to downwind")
summary(lm(pm2$Difference_in_Small~pm2$NE_Small))
plot(pm2$Difference_in_Small~pm2$NE_Small)
summary(lm(pm2$Difference_in_Small ~ pm2$coverage))
summary(lm(pmfor$Difference_in_Small ~ pmfor$coverage))
lmermodel1 <-lmer(pm2$Difference_in_Small ~ pm2$coverage + (1|pm2$winddirection), data=pm2)
source("libraries.R")
library(step)
library(lmerTest))
library(lmerTest)
source("libraries.R")
lmermodel1 <-lmer(pm2$Difference_in_Small ~ pm2$coverage + (1|pm2$winddirection), data=pm2)
anova(lmermodel1,test="Chisq")
summary(lmermodel1)
anova(lmermodel1,test="Chisq"),
summary(lmermodel1)
lmermodel1 <-lmer(pm2$Difference_in_Small ~ pm2$coverage + (1|pm2$winddirection), data=pm2)
anova(lmermodel1,test="Chisq")
summary(lmermodel1)
lmermodel1 <-lmer(pm2$Difference_in_Small ~ pm2$coverage * (1|pm2$winddirection), data=pm2)
anova(lmermodel1,test="Chisq")
summary(lmermodel1)
lmermodel1 <-lmer(pm2$Difference_in_Small ~ pm2$coverage + pm2$winddirection), data=pm2)
summary(lm(\pm2$Difference_in_Small ~ pm2$coverage + pm2$winddirection))
summary(lm(pm2$Difference_in_Small ~ pm2$coverage + pm2$winddirection)
)
summary(lm(pm2$Difference_in_Small ~ pm2$coverage * pm2$winddirection)
summary(lm(pm2$Difference_in_Small ~ pm2$coverage * pm2$winddirection))
summary(lm(pm2$Difference_in_Small ~ pm2$coverage * pm2$winddirection))
lmermodel1 <-lmer(pm2$Difference_in_Small ~ pm2$coverage * (1|pm2$winddirection), data=pm2),
anova(lmermodel1,test="Chisq"),
summary(lmermodel1)
