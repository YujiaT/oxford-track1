{
    "contents" : "#I want to look at the accumulated degree days of a sudden increase of captured flies\n#in a linear mixed model with chilling hour as fixed effects\n#station and year as random effects\n\nsource(\"libraries.R\") #libraries\nsource(\"data.R\") #import files\nsource(\"compile_lists.R\") #compiled lists with filtered years\n\n\n\nAccDD_Model = subset(AccDD_Model, select=c(Date, Station, DateNum, AccumulatedDD))\nTrap_Model = subset(Trap_Model, select=c(Year,DateNum, OrchardName,Station, Total, Sumeme))\n\n#Remove duplicates of chilling based on station and year\nChilling = subset(Chilling, !is.na(Chilling$chillhrs_blw45))\nChilling = subset(Chilling, !duplicated(subset(Chilling, select=c(Year, Station))))\nChilling = Chilling[Chilling$Year !=\"2012\", ]\nChilling_Model = Chilling\n#merge two data frames(accumulated degree days & emergence) by matching DateNum & Station\nAccDD_Model$Station = gsub(\"GERBER.A\", \"Gerber\", AccDD_Model$Station)\nAccDD_Model$Station = gsub(\"DURHAM.A\", \"Durham\", AccDD_Model$Station)\nAccDD_Model$Station = gsub(\"MANTECA.A\", \"Manteca\", AccDD_Model$Station)\nAccDD_Model$Station = gsub(\"YUBACITY.T\", \"Yubacity\", AccDD_Model$Station)\nAccDD_Model$Station = gsub(\"HOPLAND.A\", \"Hopland\", AccDD_Model$Station)\n\nAccDD_Trap = merge(AccDD_Model, Trap_Model, by = intersect(names(AccDD_Model), names(Trap_Model)))\n\n#get sum by grouping as Year & Station\n\nx <- within(AccDD_Trap, {\n  max <- ave(Total, Year, OrchardName, FUN = max)\n})\n\nAcc_over10 = subset(x, x$max == x$Total)\nAcc_over10$Percent = round(Acc_over10$Total/(Acc_over10$Sumeme)*100,2)\nAcc_10 = subset(Acc_over10, select=c(Year, Station, DateNum, AccumulatedDD, OrchardName, Total, Sumeme, Percent)) #to simplify df\nAcc_10 <- Acc_10[order(Acc_10$Station, Acc_10$DateNum),]\n\n\nfinal <- merge(Acc_10, Chilling_Model, by = intersect(names(Acc_10), names(Chilling_Model)))\nfinal <- final[final$AccumulatedDD > 1500,]\nfinal <- final[final$Chillin_.Hours_11.1.2.28.9_between_32_and_45 < 1300,]\nfinal <- final[final$chillhrs_blw45 < 1300,]\n\nmean(final$Percent)\n\nAccDD_10 <- final$AccumulatedDD\nchill3245 <- final$Chillin_.Hours_11.1.2.28.9_between_32_and_45\nchill45 <- final$chillhrs_blw45\nYear <- final$Year\nStation <- final$Station\n\n#114 points for each plots\n\nplot(chill3245,AccDD_10, main = \"Accumulated Degree Days and Chilling Hour(32-45 ??F) at Peak Emergence\",\n     xlab= \"Chilling hours between 32 ??F and 45 ??F\",\n     ylab= \"Accumulated degree days when WHF emergence is at peak\")\nsummary(lm(AccDD_10~chill3245))\nabline(lm(AccDD_10~chill3245))\n\nplot(chill45,AccDD_10, main = \"Accumulated Degree Days and Chilling Hour(below 45 ??F) at Peak Emergence\",\n     xlab= \"Chilling hours below 45 ??F\",\n     ylab= \"Accumulated degree days when WHF emergence is at peak\")\nsummary(lm(AccDD_10~chill45))\nabline(lm(AccDD_10~chill45))\n\n\n\n#Finally!\nlmermodel1 <-lmer(AccDD_10 ~ chill3245 + (1|Year) + (1|Station), data=final)\nanova(lmermodel1,test=\"Chisq\")\nsummary(lmermodel1)\n\nlmermodel2 <-lmer(AccDD_10 ~ chill45 + (1|Year) + (1|Station), data=final)\nanova(lmermodel2,test=\"Chisq\")\nsummary(lmermodel2)\n\n",
    "created" : 1444845967653.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2967820521",
    "id" : "67FC258B",
    "lastKnownWriteTime" : 1441606495,
    "path" : "E:/Mills-Lab/peak emergence/Model.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "type" : "r_source"
}